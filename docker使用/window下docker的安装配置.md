
---

# Windows æœ¬åœ°å¼€å‘çŽ¯å¢ƒæ­å»º (Dockerç‰ˆ)

**æ ¸å¿ƒé€»è¾‘**ï¼š
*   **ä»£ç è¿è¡Œ**ï¼šç›´æŽ¥åœ¨ Windows (Dç›˜) è¿è¡Œ
*   **æ•°æ®åº“è¿è¡Œ**ï¼šåœ¨ WSL2 (Docker) ä¸­è¿è¡Œã€‚
*   **è¿žæŽ¥æ–¹å¼**ï¼šé€šè¿‡ `localhost` ç«¯å£æ˜ å°„è¿žæŽ¥ã€‚

---

## 1. åŸºç¡€çŽ¯å¢ƒå®‰è£…

### ç¬¬ä¸€æ­¥ï¼šå®‰è£… WSL 2
1.  **å¼€å¯**ï¼šå³é”®å¼€å§‹èœå• -> **ç»ˆç«¯(ç®¡ç†å‘˜)**ï¼Œæ‰§è¡Œï¼š
    ```powershell
    wsl --install
    ```
    *(è‹¥æç¤ºå·²å®‰è£…ï¼Œæ‰§è¡Œ `wsl --update`)*
2.  **é‡å¯**ï¼šé‡å¯ç”µè„‘ï¼Œç­‰å¾… Ubuntu ç»ˆç«¯å¼¹å‡ºï¼ŒæŒ‰æç¤ºè®¾ç½®ç”¨æˆ·å/å¯†ç ã€‚

### ç¬¬äºŒæ­¥ï¼šå®‰è£… Docker Desktop
1.  **ä¸‹è½½**ï¼šå®˜ç½‘ä¸‹è½½ [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop/) å¹¶å®‰è£…ã€‚
2.  **é…ç½®** (å…³é”®)ï¼š
    *   æ‰“å¼€ Docker Desktop è®¾ç½® (âš™ï¸å›¾æ ‡)ã€‚
    *   **General**: å‹¾é€‰ `Use the WSL 2 based engine`ã€‚
    *   **Resources > WSL Integration**: å¼€å¯ `Ubuntu` å¼€å…³ã€‚
    *   ç‚¹å‡» `Apply & restart`ã€‚

---

## 2. æ•°æ®åº“é…ç½® (Docker Compose)

åœ¨ D ç›˜å»ºç«‹ä¸€ä¸ªç›®å½•ä¸“é—¨ç®¡ç†çŽ¯å¢ƒï¼Œä¾‹å¦‚ `D:\DevEnv`ï¼Œåœ¨é‡Œé¢åˆ›å»º `docker-compose.yml`ã€‚

**æ–‡ä»¶å†…å®¹**ï¼š
```yaml
version: '3.8'

services:
  # --- Redis ---
  redis:
    image: redis:latest
    container_name: my-redis
    restart: always
    command: redis-server --requirepass "redis123" --appendonly yes
    ports:
      - "6379:6379"  # å¼€æ”¾ç«¯å£ç»™ Windows
    volumes:
      - ./redis_data:/data

  # --- Postgres ---
  postgres:
    image: postgres:15
    container_name: my-pg
    restart: always
    environment:
      POSTGRES_USER: root
      POSTGRES_PASSWORD: pg123
      POSTGRES_DB: mydb
    ports:
      - "5432:5432"  # å¼€æ”¾ç«¯å£ç»™ Windows
    volumes:
      - ./pg_data:/var/lib/postgresql/data
```


---

## 3. å¯åŠ¨ä¸Žç®¡ç†å‘½ä»¤

åœ¨ `D:\DevEnv` ç›®å½•ä¸‹æ‰“å¼€ PowerShell æˆ– CMDï¼š

*   **å¯åŠ¨æ‰€æœ‰æœåŠ¡** (åŽå°)ï¼š
    ```bash
    docker-compose up -d
    # -d è¡¨ç¤º Detachedï¼ˆåŽå°è¿è¡Œï¼‰ï¼Œä¸å ç”¨å½“å‰ç»ˆç«¯çª—å£
    ```
*   **åœæ­¢æœåŠ¡**ï¼š
    ```bash
    docker-compose down
    ```
*   **æŸ¥çœ‹çŠ¶æ€** (æ£€æŸ¥æ˜¯å¦ Up)ï¼š
    ```bash
    docker-compose ps
    # çŠ¶æ€å¿…é¡»æ˜¯ "Up"ï¼Œå¦‚æžœæ˜¯ "Exit" è¯´æ˜Žå¯åŠ¨æŠ¥é”™äº†
    ```
3.  **æŸ¥çœ‹é”™è¯¯æ—¥å¿—** (å¦‚æžœå¯åŠ¨å¤±è´¥)ï¼š
    ```bash
    docker-compose logs postgres
    # æŸ¥çœ‹ postgres çš„æŠ¥é”™ä¿¡æ¯
    ```
---

## 4. DBeaver è¿žæŽ¥æ£€æŸ¥

æ‰“å¼€ DBeaverï¼Œæ–°å»º **PostgreSQL** è¿žæŽ¥ï¼š

*   **ä¸»æœº (Host)**: `localhost`  *(ä¸è¦å¡« IPï¼Œç›´æŽ¥ localhost)*
*   **ç«¯å£ (Port)**: `5432`
*   **æ•°æ®åº“**: `mydb`
*   **ç”¨æˆ·å**: `root`
*   **å¯†ç **: `pg123`
*   **æ“ä½œ**: ç‚¹å‡» `æµ‹è¯•è¿žæŽ¥ (Test Connection)`ã€‚
    *   *æˆåŠŸæ˜¾ç¤º "Connected" è¡¨ç¤ºçŽ¯å¢ƒé€šäº†ã€‚*

**Redis æ£€æŸ¥æ–¹æ³•**ï¼š
ä½¿ç”¨ Windows ä¸Šçš„ Redis å®¢æˆ·ç«¯ (å¦‚ RDM) è¿žæŽ¥ `localhost:6379`ï¼Œå¯†ç  `redis123`ã€‚

## 5. å¸¸è§é—®é¢˜æŽ’é”™

1.  **DBeaver è¿žä¸ä¸Š**ï¼š
    *   æ£€æŸ¥ Docker Desktop ä¹Ÿå°±æ˜¯å¦è¿è¡Œä¸­ (å³ä¸‹è§’é²¸é±¼å›¾æ ‡)ã€‚
    *   æ‰§è¡Œ `docker-compose ps` ç¡®è®¤çŠ¶æ€æ˜¯ `Up` è€Œä¸æ˜¯ `Exit`ã€‚
    *   æ£€æŸ¥ç«¯å£ 5432 æ˜¯å¦è¢« Windows æœ¬åœ°å®‰è£…çš„ PostgreSQL å ç”¨äº† (å¦‚æžœæœ‰ï¼Œæ”¹ yaml é‡Œçš„ç«¯å£ä¸º `5433:5432`)ã€‚
2.  **æ•°æ®åœ¨å“ªé‡Œ**ï¼š
    *   æ•°æ®åœ¨ä½  `D:\DevEnv` ä¸‹çš„ `pg_data` å’Œ `redis_data` æ–‡ä»¶å¤¹é‡Œï¼Œåªè¦ä¸åˆ è¿™ä¿©ï¼Œé‡å¯ç”µè„‘æ•°æ®ä¹Ÿä¸ä¸¢ã€‚




è¿™æ˜¯æ‰€æœ‰ Docker æ–°æ‰‹éƒ½ä¼šé‡åˆ°çš„**ç»å…¸â€œå¤§å‘â€**ï¼Œåˆ«æ…Œï¼Œéžå¸¸å¥½è§£å†³ã€‚

### ä¿®æ”¹å¯†ç 

åŽŸå› æ˜¯ **PostgreSQL çš„åˆå§‹åŒ–æœºåˆ¶** ä»¥åŠ **Docker çš„æ•°æ®æŒä¹…åŒ–**ã€‚

`POSTGRES_USER` å’Œ `POSTGRES_PASSWORD` è¿™ä¸¤ä¸ªçŽ¯å¢ƒå˜é‡ï¼Œ**åªæœ‰åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨å®¹å™¨ï¼ˆä¹Ÿå°±æ˜¯ `./pg_data` æ–‡ä»¶å¤¹å®Œå…¨ä¸ºç©ºï¼‰æ—¶ï¼Œæ‰ä¼šç”Ÿæ•ˆ**ã€‚

æµç¨‹æ˜¯è¿™æ ·çš„ï¼š
1. ä½ ç¬¬ä¸€æ¬¡ `up -d`ï¼ŒPostgres å‘çŽ° `./pg_data` æ˜¯ç©ºçš„ï¼ŒäºŽæ˜¯å®ƒ**åˆå§‹åŒ–äº†æ•°æ®åº“**ï¼Œå¹¶å†™å…¥äº†ä½ æœ€åˆçš„è´¦å·å¯†ç ã€‚
2. ä½  `down` æŽ‰äº†å®¹å™¨ã€‚ä½†æ˜¯ï¼**`./pg_data` æ–‡ä»¶å¤¹é‡Œçš„æ•°æ®æ–‡ä»¶ä¾ç„¶ä¿ç•™åœ¨ä½ çš„ç”µè„‘ä¸Š**ã€‚
3. ä½ æ”¹äº† yaml æ–‡ä»¶ï¼Œå†æ¬¡ `up -d`ã€‚Postgres å¯åŠ¨æ—¶æ£€æµ‹åˆ° `./pg_data` é‡Œå·²ç»æœ‰æ•°æ®äº†ï¼Œå®ƒå°±ä¼š**è·³è¿‡åˆå§‹åŒ–æ­¥éª¤ï¼Œç›´æŽ¥åŠ è½½æ—§æ•°æ®**ã€‚æ­¤æ—¶ï¼Œä½ æ–°æ”¹çš„çŽ¯å¢ƒå˜é‡è¢«å®ƒå®Œå…¨æ— è§†äº†ï¼Œæ‰€ä»¥ç”Ÿæ•ˆçš„ä»ç„¶æ˜¯ä½ ç¬¬ä¸€æ¬¡è®¾ç½®çš„æ—§è´¦å·å’Œæ—§å¯†ç ã€‚

---

### è§£å†³æ–¹æ³•

æ—¢ç„¶æƒ³ç”¨æ–°è´¦å·å¯†ç ï¼Œå°±å¿…é¡»è®© Postgres é‡æ–°åˆå§‹åŒ–ã€‚

**æ­¥éª¤å¦‚ä¸‹ï¼š**

1. **åœæ­¢å¹¶åˆ é™¤å®¹å™¨**ï¼š
   åœ¨ç»ˆç«¯è¾“å…¥ï¼š
   ```bash
   docker-compose down
   ```

2. **åˆ é™¤æ—§çš„æ•°æ®æ–‡ä»¶å¤¹ (å…³é”®æ­¥)**ï¼š
   æ‰“å¼€ä½ çš„ç”µè„‘ D ç›˜ï¼Œæ‰¾åˆ°å­˜æ”¾è¿™ä¸ªé¡¹ç›®çš„ç›®å½•ï¼Œ**æ‰‹åŠ¨åˆ é™¤ `pg_data` æ–‡ä»¶å¤¹**ã€‚ï¼ˆæ—¢ç„¶æ˜¯åˆšå»ºçš„çŽ¯å¢ƒï¼Œé‡Œé¢æ²¡æœ‰é‡è¦æ•°æ®ï¼Œæ”¾å¿ƒåˆ ï¼‰ã€‚

3. **é‡æ–°å¯åŠ¨**ï¼š
   åœ¨ç»ˆç«¯å†æ¬¡è¾“å…¥ï¼š
   ```bash
   docker-compose up -d
   ```

**ç»“æžœï¼š**
è¿™æ—¶å€™å› ä¸º `pg_data` æ²¡äº†ï¼ŒPostgres ä¼šé‡æ–°ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶è¯»å–ä½ æ–°çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œåˆå§‹åŒ–ã€‚è¿™æ—¶å€™ä½ å†åŽ»è¿žï¼Œæ–°çš„è´¦å·å¯†ç å°±èƒ½è¿žä¸Šäº†ï¼

---

### ðŸ’¡ è¿›é˜¶å°ç¬”è®°
> å¦‚æžœä»¥åŽä½ çš„æ•°æ®åº“é‡Œå·²ç»æœ‰äº†é‡è¦çš„ä¸šåŠ¡æ•°æ®ï¼Œ**ä¸èƒ½åˆ  `pg_data`**ï¼Œåˆæƒ³æ”¹å¯†ç æ€Žä¹ˆåŠžï¼Ÿ
> ç­”ï¼š**ä¸è¦æ”¹ `docker-compose.yml`**ã€‚ç›´æŽ¥ç”¨æ—§å¯†ç è¿žä¸Š DBeaverï¼Œåœ¨ DBeaver é‡Œç”¨ SQL è¯­å¥ä¿®æ”¹å¯†ç ï¼š
> `ALTER USER root WITH PASSWORD 'new_password';`