# OpenCV开发准备

## 环境准备 - Jupyter Notebook

学OpenCV建议用Jupyter Notebook，能边写代码边看效果，特别适合做图像处理。

### 什么是Jupyter Notebook？

简单说就是一个在浏览器里写代码的工具，可以：
- 一边写代码一边运行，立马看到结果
- 代码、图片、文字混在一起，方便做笔记
- 特别适合做数据分析和图像处理

### 安装Jupyter Notebook

**方法1：直接用pip安装（推荐）**
```bash
pip install jupyter notebook
```

**方法2：安装完整版JupyterLab（功能更强）**
```bash
pip install jupyterlab
```

**如果pip慢，用国内镜像：**
```bash
pip install jupyter notebook -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 启动Jupyter Notebook

**1. 打开命令行（CMD或PowerShell）**

**2. 切换到你的工作目录：**
```bash
cd D:\你的项目文件夹
```

**3. 启动Notebook：**
```bash
jupyter notebook
# 或者启动JupyterLab
jupyter lab
```

**4. 自动打开浏览器**
- 会自动弹出浏览器，地址一般是：`http://localhost:8888`
- 如果没弹出，复制命令行里的链接（带token的）到浏览器
![[Pasted image 20251020133342.png]]
### 基本使用

**创建新的Notebook：**
1. 点击右上角 `New` → `Python 3`
2. 或者在JupyterLab里点击 `File` → `New` → `Notebook`

**运行代码：**
- 在单元格里写代码
- ==按 `Shift + Enter` 运行当前单元格==
- 或点击上面的 ▶️ 运行按钮

**常用快捷键：**
- `Shift + Enter`：运行当前单元格，跳到下一个
- `Ctrl + Enter`：运行当前单元格，停留在当前
- `A`：在上方插入新单元格
- `B`：在下方插入新单元格
- `D + D`：删除当前单元格
- `M`：把单元格改成Markdown（写文字用）
- `Y`：把单元格改成代码

**保存文件：**
- `Ctrl + S`：保存
- 文件后缀是 `.ipynb`

### 在Notebook里测试OpenCV

创建一个新的Notebook，试试下面的代码：

```python
# 1. 导入库
import cv2
import numpy as np
import matplotlib.pyplot as plt

# 显示版本
print(f'OpenCV版本：{cv2.__version__}')
print(f'NumPy版本：{np.__version__}')

# 2. 测试显示图片
# 创建一个彩色渐变图
img = np.zeros((300, 400, 3), dtype=np.uint8)
for i in range(300):
    img[i, :] = [i*255//300, 128, 255-i*255//300]

# 用matplotlib显示
plt.figure(figsize=(8, 6))
plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
plt.title('测试图片 - 环境配置成功！')
plt.axis('off')
plt.show()

print('✅ 环境配置成功！可以开始学OpenCV了')
```

**运行成功的话，会看到：**
- 版本号信息
- 一张彩色渐变图
- ✅ 环境配置成功！可以开始学OpenCV了

### 小技巧

**1. 让图片显示在Notebook里：**
```python
# 不用cv2.imshow()，用matplotlib
import matplotlib.pyplot as plt
plt.imshow(img)
plt.show()
```
![[Pasted image 20251020134124.png]]
**2. 设置图片显示大小：**
```python
plt.figure(figsize=(10, 8))  # 宽10英寸，高8英寸
plt.imshow(img)
plt.show()
```

**3. 关闭自动输出：**
```python
# 在代码最后加分号，不显示返回值
plt.imshow(img);
```

**4. 显示中文（如果图片标题需要中文）：**
```python
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['SimHei']  # 黑体
plt.rcParams['axes.unicode_minus'] = False    # 解决负号显示问题
```

### 常见问题

**Q1：启动notebook后浏览器打不开？**
- 手动复制命令行里的链接（带token的）到浏览器
- 或者试试：`jupyter notebook --no-browser`，然后手动复制链接

**Q2：想在其他文件夹启动怎么办？**
- 先 `cd` 到那个文件夹，再启动 `jupyter notebook`

**Q3：怎么关闭Notebook？**
- 在命令行按 `Ctrl + C` 两次
- 或者在浏览器里点 `Quit`

**Q4：图片显示不出来？**
- 检查是否用了 `plt.show()`
- 如果用的cv2.imshow()在notebook里不行，要用matplotlib

---

## OpenCV简介

OpenCV全称是 Open Source Computer Vision Library（开源计算机视觉库），简单说就是一个专门用来处理图像和视频的工具包。

**能干啥？**
- 读取、显示、保存图片和视频
- 图像处理（滤波、边缘检测、颜色转换等）
- 目标检测和识别（人脸检测、物体识别）
- 图像分割、特征提取
- 视频分析、运动跟踪
- 3D重建、相机标定

**为什么用OpenCV？**
- 免费开源，跨平台（Windows、Linux、Mac都能用）
- 功能强大，基本上图像处理能想到的功能都有
- 性能好，底层用C++写的，速度快
- 社区活跃，资料多，遇到问题好解决

## 部署方式

### Python环境安装（最常用）
```bash
pip install opencv-python         # 基础版本，够用了
pip install opencv-contrib-python # 完整版本，包含扩展模块
```

**注意事项：**
- Python版本建议3.7以上
- 如果pip慢可以用国内镜像：`pip install opencv-python -i https://pypi.tuna.tsinghua.edu.cn/simple`

### 验证安装
```python
import cv2
print(cv2.__version__)  # 打印版本号，能输出就说明装好了
```

### 其他部署方式
- **C++**：需要编译源码或者下载预编译包，配置比较麻烦，性能最好
- **Java/Android**：用于安卓开发
- **JavaScript**：OpenCV.js，可以在浏览器里跑

## 常用配套库

OpenCV本身挺强大，但一般会搭配其他库一起用，效率更高：

### 必装的库

==**1. NumPy（必须有！）**==
```bash
pip install numpy
```
- ==OpenCV的图像在Python里其实就是NumPy数组==
- 可以用NumPy做各种数学运算、数组操作
- 比如：`img[100:200, 150:250]` 这种切片操作就是NumPy的语法

==**2. Matplotlib（用来显示图片）**==
```bash
pip install matplotlib
```
- 在Jupyter notebook里显示图片特别方便
- 可以一次显示多张图片对比
- 比OpenCV的窗口显示更灵活

### 可选但推荐的库

**3. Pillow（PIL）**
```bash
pip install pillow
```
- 也是个图像处理库，功能比OpenCV简单
- 有时候OpenCV和Pillow互相转换用

**4. scikit-image**
```bash
pip install scikit-image
```
- 科学图像处理库，偏学术研究
- 有些OpenCV没有的高级算法

**5. imutils**
```bash
pip install imutils
```
- 对OpenCV的一些常用操作做了封装
- 比如旋转、缩放图片更方便

### 典型的导入代码
```python
import cv2              # OpenCV
import numpy as np      # NumPy
import matplotlib.pyplot as plt  # 画图用
```

## OpenCV主要模块

OpenCV分成很多模块，每个模块负责不同的功能：

### 核心模块（常用）

==**1. core（核心模块）**==
- 最基础的模块，定义了基本的数据结构
- ==Mat类（存储图像数据）==
- 基本的数学运算、数组操作

==**2. imgproc（图像处理）**==
- 图像滤波（模糊、锐化）
- 几何变换（缩放、旋转、仿射变换）
- 颜色空间转换（RGB、灰度、HSV等）
- 形态学操作（膨胀、腐蚀）
- 边缘检测（Canny、Sobel）
- 直方图处理

==**3. imgcodecs（图像文件读写）**==
- 读取图片：imread()
- 保存图片：imwrite()
- 支持常见格式：jpg、png、bmp等

==**4. videoio（视频输入输出）**==
- 读取视频文件
- 调用摄像头
- 保存视频

==**5. highgui（图形界面）**==
- 显示图片和视频
- 创建窗口、滑动条
- 鼠标键盘事件处理

### 进阶模块（后面会用到）

**6. objdetect（目标检测）**
- 人脸检测、行人检测
- 基于Haar级联分类器、HOG检测器

**7. features2d（特征检测）**
- SIFT、SURF、ORB等特征点检测
- 特征匹配

**8. calib3d（相机标定和3D重建）**
- 相机标定
- 立体视觉
- 姿态估计

**9. ml（机器学习）**
- SVM、KNN、决策树等传统机器学习算法

**10. dnn（深度学习）**
- 加载和运行预训练的深度学习模型
- 支持TensorFlow、PyTorch等框架的模型

**11. photo（计算摄影学）**
- 图像修复、去噪
- HDR处理、图像融合

---
